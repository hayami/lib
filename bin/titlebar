#!/bin/sh

# In addition to this script, the xtitle command and others may
# have similar functions. For the xtitle information, visit the
# following URL: https://legacy.cs.indiana.edu/~kinzler/xtitle/

#	From: masaoki@akebono.tky.yhp.co.jp (Kobayashi Masaoki)
#	Date: Wed, 10 Nov 1993 23:22:45 GMT
#	Subject: Re: [WANTED] xtitle
#	Message-ID: <29470002@akebono.tky.yhp.co.jp>
#	Organization: YHP Hachioji HSTD R&D, Tokyo Japan
#	Newsgroups: fj.wanted
#	
#	kterm ãªã‚‰ã€
#		echo "^[]2;hogehoge^G^[]1;piropiro^G"
#	ã§ã€ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ã¯"hogehoge"ã«ã€ã‚¢ã‚¤ã‚³ãƒ³åã¯"piropiro"ã«ãª
#	ã‚Šã¾ã™ã€‚ã‚‚ã¡ã‚ã‚“ã€'^[' ã¯ "ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—"ã€'^G' ã¯ "CTRL-G" ã§ã™ã€‚
#	
#	From: nomura@meis.sony.co.jp (Eiji Nomura)
#	Newsgroups: fj.wanted
#	Subject: Re: [WANTED] xtitle
#	Message-ID: <NOMURA.93Nov16194731@Libra.meis.sony.co.jp>
#	Date: 16 Nov 93 10:47:31 GMT
#						
#	kterm ã«é™ã‚‰ãš VT100ã®(ã¡ã‚ƒã‚“ã¨ã—ãŸ? :p)ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ãªã‚‰
#	å‹•ä½œã—ã¦ãã‚Œã‚‹ã¨æ€ã„ã¾ã™ã€‚ç§ã‚‚
#		echo -n "^[]0;"$*"^G"
#	ã ã‘æ›¸ã„ãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ rename ã¨è¨€ã†åå‰ã§ä½œã£ã¦ã‚ã‚Šã¾ã™ã€‚
#	(ã¡ãªã¿ã« 0 ã ã¨ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ã¨ã‚¢ã‚¤ã‚³ãƒ³åã®ä¸¡æ–¹å¤‰ãˆã‚‰ã‚Œã¾ã™)
#	VT100é–¢é€£ã®ä»–ã®ã‚³ãƒãƒ³ãƒ‰ã¨ã—ã¦ã€
#		echo -n "^[[31m"
#	ã‚’ RED ãªã‚“ã¦åå‰ã§ç™»éŒ²ã—ã¦ã„ã¾ã™(ç¬‘)
#	(ã‚«ãƒ©ãƒ¼ã®ç«¯æœ«ã˜ã‚ƒãªã„ã¨æ„å‘³ä¸æ˜ã ãª :-)
#
case "$maxlen" in [0-9]|[0-9][0-9]|[0-9][0-9][0-9]) ;; *) maxlen=; esac

case "${##*/}" in
dostitle)
    # ãªã‚“ã‹é•·ã™ãã‚‹ã¨å›ºã¾ã‚‹æ¨¡æ§˜ã€‚ã©ã“ã¾ã§ãƒ¡ãƒ¢ãƒªè²§ä¹ãªã‚“ã ã‚ã† > Windows 10
    # æœ€å¤§ maxlen æ–‡å­—ã§åã‚ã‚‹ã‚ˆã†ã«ã—ãŸã€‚æ–‡å­—åˆ—ã®é•·ã•ã®è¨ˆç®—ã¯å³å¯†ã§ã¯ãªã„ã€‚

    # usage: cmd.exe /C powershell -command "Write-Host -NoNewline '$(dostitle HELO WORLD)'" '&' ...
    maxlen=${maxlen:-80} ;;
*)  maxlen=${maxlen:-0}  ;;
esac

last="$*"
if [ $maxlen -gt 0 -a ${#last} -gt $maxlen ]; then
    head=
    str=
    set -- $*
    for i in $@; do
        last="$str"
        head="$head$1 "
        shift
        tail="$*"
        str="${head}... (${#tail} chars)"
        [ ${#str} -le $maxlen ] || break
    done
fi
[ -n "$last" ] || last='(too long)'
echo -n ']0;'"$last"''
